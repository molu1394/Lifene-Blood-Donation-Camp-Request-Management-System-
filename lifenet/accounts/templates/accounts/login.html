<!DOCTYPE html>
{%load static%}
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - LifeNet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{%static 'css/loginpage.css' %}">
  <link rel="stylesheet" href="{%static 'css/message.css'%}">
</head>

<body>
<div class="messagesbox">
    {% if messages %}
        <div class="messages">
            {% for message in messages|dictsortreversed:"level" %}
                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

  
    {% if form.non_field_errors %}
        {% for error in form.non_field_errors %}
            <div class="alert alert-danger">
                {{ error }}
            </div>
        {% endfor %}
    {% endif %}

    
    {% if form.errors %}
        {% for field, errors in form.errors.items %}
            {% for error in errors %}
                {% if forloop.last and forloop.parentloop.last %}
                    <div class="alert alert-danger">
                        <strong>{{ field|capfirst }}:</strong> {{ error }}
                    </div>
                {% endif %}
            {% endfor %}
        {% endfor %}
    {% endif %}
</div>


  <div class="login-card">
    <div class="login-header">
      <i class="bi bi-person-circle"></i>
      {% if role == "donor" %}
        <h3 class="mt-2">Donor Login to LifeNet</h3>
      {% elif role == "patient" %}
        <h3 class="mt-2">Patient Login to LifeNet</h3>
      {% elif role == "bloodbank" %}
        <h3 class="mt-2">BloodBank Login to LifeNet</h3>
      {% elif role == "org" %}
        <h3 class="mt-2">Organization Login to LifeNet</h3>
      {% elif role == "staff" %}
        <h3 class="mt-2">Staff Login to LifeNet</h3>
      {% elif role == "admin" %}
        <h3 class="mt-2">Admin Login to LifeNet</h3>
      {% endif %}
      
      <p>Access your account to manage blood donations & requests</p>
    </div>
    <form id="loginForm" method="post">
      {% csrf_token %}
      
      <div class="mb-3">
        <label for="username" class="form-label fw-semibold">Username</label>
        {{ form.username }}
      </div>

      <div class="mb-3">
        <label for="password" class="form-label fw-semibold">Password</label>
        {{ form.password }}
      </div>
      <p class="forgot_password">
        {% if role == "donor" %}
        <a href="{% url 'accounts:forgot_password' role='Donor' %}">Forgot password</a>
        {% elif role == "patient" %}
        <a href="{% url 'accounts:forgot_password' role='Patient' %}">Forgot password</a>
        {% elif role == "bloodbank" %}
        <a href="{% url 'accounts:forgot_password' role='Blood Bank' %}">Forgot password</a>
        {% elif role == "org" %}
        <a href="{% url 'accounts:forgot_password' role='org' %}">Forgot password</a>
        {% elif role == "staff" %}
        <a href="{% url 'accounts:forgot_password' role='Staff' %}">Forgot password</a>
        {% endif %}
      </p>
      <button type="submit" class="btn btn-login w-100">Login</button>

    </form>

    <p class="mt-4 text-center">
      {% if role == "donor" %}
      Don’t have an account?
      <a href="{% url 'accounts:register-donor' %}">Sign Up</a>
      {% elif role == "patient" %}
      Don’t have an account?
      <a href="{% url 'accounts:register-patient' %}">Sign Up</a>
      {% elif role == "bloodbank" %}
      Don’t have an account?
      <a href="{% url 'accounts:register-bloodbank' %}">Sign Up</a>
      {% elif role == "org" %}
      Don’t have an account?
      <a href="{% url 'accounts:register-org' %}">Sign Up</a>
      {% elif role == "staff" %}
      Don’t have an account?
      <a href="{% url 'accounts:register-staff' %}">Sign Up</a>
      {% endif %}
    </p>
  </div>

</body>
</html>